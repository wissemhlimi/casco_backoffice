(this["webpackJsonpapp-frontend"]=this["webpackJsonpapp-frontend"]||[]).push([[105],{1100:function(e,t,n){"use strict";var a=n(5),i=function(e){return e.planning.view},r=Object(a.a)([i],(function(e){return e.record})),c={selectLoading:Object(a.a)([i],(function(e){return Boolean(e.loading)})),selectRecord:r,selectRaw:i};t.a=c},1417:function(e,t,n){},1576:function(e,t,n){"use strict";n.r(t);var a=n(11),i=n(2),r=n(45),c=n(37),o=n(3),l=n(240),d=n(1100),u=n(0),s=n(1),p=n.n(s),j=n(4),b=n(209),m=n(699),f=n(949),y=n(950),O=n(1534),x=(n(1417),n(870)),g=n(823),h=n(115),w=n.n(h),v=(n(1418),n(92)),C=function(e){var t,n=Object(i.useState)({}),r=Object(b.a)(n,2),c=r[0],o=r[1],l=Object(i.useState)({}),d=Object(b.a)(l,2),u=d[0],s=d[1],m=Object(i.useState)(),f=Object(b.a)(m,2),y=f[0],O=f[1],g=window.location.pathname.split("planning/").pop().replace("/daily",""),h=function(){var n=Object(j.a)(p.a.mark((function n(){return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v.a.find(g);case 2:t=n.sent,s(t),t.line.map((function(n){n.name===e.data.lineParent&&(n.product.map((function(n,a){t.product.map((function(e){e.id===n.id&&(n.quantityPlanned=e.quantityPlannedTotal)})),n.days.map((function(t,n){e.header.toLowerCase().includes(t.day)&&O(n)})),n.quantityPlanned>0&&n.days.map((function(e){e.priority=a+1}))})),o(n))})),e.onSubmit(t);case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();Object(i.useEffect)((function(){h()}),[e]);var w=function(){var t=Object(j.a)(p.a.mark((function t(n){var a,i,r,o,l,d,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n.length>0)){t.next=49;break}if(!Object.values(n[0].data)[0].quantity){t.next=10;break}return r=u,t.next=5,u.line.map((function(e,t){e.name===c.name&&(i=t)}));case 5:return t.next=7,u.line[i].product.map((function(e,t){n[0].key.id===e.id&&(a=t)}));case 7:r.line[i].product[a].days[y].quantity=Object.values(n[0].data)[0].quantity,t.next=48;break;case 10:if(!Object.values(n[0].data)[0].priority){t.next=19;break}return r=u,t.next=14,u.line.map((function(e,t){e.name===c.name&&(i=t)}));case 14:return t.next=16,u.line[i].product.map((function(e,t){n[0].key.id===e.id&&(a=t)}));case 16:r.line[i].product[a].days[y].priority=Object.values(n[0].data)[0].priority,t.next=48;break;case 19:if("priorityChecked"!==Object.keys(Object.values(n[0].data)[0])[0]){t.next=48;break}return r=u,o=0,l=0,t.next=25,u.line.map((function(e,t){e.name===c.name&&(i=t)}));case 25:return t.next=27,u.line[i].product.map((function(e,t){n[0].key.id===e.id&&(a=t),e.days[y].priorityChecked&&o++,null!==e.days[y].priority&&e.days[y].priority>l&&(l=e.days[y].priority)}));case 27:if(!0!==Object.values(n[0].data)[0].priorityChecked){t.next=47;break}if(0!==o){t.next=39;break}if(null!==r.line[i].product[a].days[y].priority){t.next=33;break}r.line[i].product[a].days[y].priority=l+1,t.next=37;break;case 33:return d=r.line[i].product[a].days[y].priority,t.next=36,u.line[i].product.map((function(e){e.days[y].priority===o+1&&(e.days[y].priority=d)}));case 36:r.line[i].product[a].days[y].priority=o+1;case 37:t.next=47;break;case 39:if(null!==r.line[i].product[a].days[y].priority){t.next=43;break}r.line[i].product[a].days[y].priority=l+1,t.next=47;break;case 43:return s=r.line[i].product[a].days[y].priority,t.next=46,u.line[i].product.map((function(e){e.days[y].priority===o+1&&(e.days[y].priority=s)}));case 46:r.line[i].product[a].days[y].priority=o+1;case 47:r.line[i].product[a].days[y].priorityChecked=Object.values(n[0].data)[0].priorityChecked;case 48:e.onSubmit(r);case 49:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsxs)(x.DataGrid,{dataSource:c.product,showBorders:!0,columnAutoWidth:!0,allowColumnResizing:!0,columnResizingMode:"widget",onCellPrepared:function(e){"Quantity"===e.column.caption&&"data"===e.rowType&&(e.cellElement.style.background="#0aa3a3"),"Priority"===e.column.caption&&"data"===e.rowType&&(e.cellElement.style.background="#0aa3a3")},children:[Object(a.jsx)(x.Selection,{mode:"single"}),Object(a.jsx)(x.Editing,{allowUpdating:!0,allowAdding:!1,allowDeleting:!1,mode:"cell",onChangesChange:function(e){return w(e)}}),Object(a.jsx)(x.ColumnChooser,{enabled:!0,mode:"select"}),Object(a.jsx)(x.Column,{dataField:"familyParent",allowEditing:!1}),Object(a.jsx)(x.Column,{dataField:"id",allowEditing:!1}),Object(a.jsx)(x.Column,{caption:"SB",dataField:"subassembly",dataType:"boolean",allowEditing:!1}),Object(a.jsx)(x.Column,{caption:"FG",dataField:"finishGood",dataType:"boolean",allowEditing:!1}),Object(a.jsx)(x.Column,{caption:"Total Quantity Planned",dataField:"quantityPlanned",allowEditing:!1}),Object(a.jsxs)(x.Column,{caption:"Quantity Planned",allowEditing:!1,children:[Object(a.jsx)(x.Column,{caption:"Current Line",dataField:"quantity",allowEditing:!1,cellRender:function(e){return function(e){var t=0;return e.data.days.map((function(e){t+=e.quantity})),Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("div",{children:t})})}(e)}}),Object(a.jsx)(x.Column,{caption:"Other Lines",dataField:"otherLines",allowEditing:!1,cellRender:function(e){return function(e){var t=0,n=u;return 1===e.data.lineParent.length?t=0:n.line.map((function(n){n.name!==c.name&&e.data.lineParent.includes(n.name)&&n.product.map((function(n){n.days.map((function(a){n.id===e.data.id&&(t+=a.quantity)}))}))})),Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("div",{children:t})})}(e)}})]}),Object(a.jsx)(x.Column,{dataField:"quantityRemained",allowEditing:!1,cellRender:function(e){return function(e){var t=0;return e.data.days.map((function(e){t+=e.quantity})),Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("div",{children:e.data.quantityRequested>=t?e.data.quantityRequested-t:0})})}(e)}}),Object(a.jsx)(x.Column,{caption:"Quantity",dataField:"days[".concat(y,"].quantity"),allowEditing:!0}),Object(a.jsx)(x.Column,{caption:"Priority",dataField:"days[".concat(y,"].priority"),dataType:"number",allowEditing:!0}),Object(a.jsx)(x.Column,{caption:"",dataField:"days[".concat(y,"].priorityChecked"),dataType:"boolean",allowEditing:!0})]})},k=n(91),P=n(957),E=function(e){var t=Object(r.d)(),n=Object(c.h)(),s=Object(r.e)(d.a.selectLoading),h=Object(r.e)(d.a.selectRecord),E=Object(i.useState)(!1),S=Object(b.a)(E,2),Y=S[0],D=S[1],R=Object(i.useState)(""),F=Object(b.a)(R,2),q=F[0],I=F[1],M=Object(i.useState)({}),T=Object(b.a)(M,2),z=T[0],B=T[1],L=Object(i.useState)(1e3),G=Object(b.a)(L,2),A=(G[0],G[1],function(){var e=Object(j.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("newRecord")||null)){e.next=4;break}return e.next=4,v.a.update(h.id,JSON.parse(t));case 4:D(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());Object(i.useEffect)((function(){Y||t(l.a.doFind(n.params.id))}),[!Y]);var J=Object(i.useState)([{familyParent:"",zapParent:"",lineParent:""}]),Q=Object(b.a)(J,2),N=Q[0],W=Q[1],U=function(){var e=Object(j.a)(p.a.mark((function e(){var t,n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{familyParent:"",zapParent:"",lineParent:""}],n={familyParent:"",zapParent:"",lineParent:""},e.next=4,k.a.find(h.config.id);case 4:(a=e.sent).family.map((function(e){e.linesId.map((function(i){n={familyParent:e.famId.famTitle,zapParent:"",lineParent:i.lineId.lineTitle},a.zapId.map((function(e){e.linesId.map((function(t){t.lineTitle===i.lineId.lineTitle&&(n.zapParent=e.zapTitle)}))})),t.push(n)}))})),t.shift(),W(t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(Object(i.useEffect)((function(){!s&&h&&U()}),[!s&&h]),s||!h)return Object(a.jsx)(m.a,{});function Z(){var e=new Date(null===h||void 0===h?void 0:h.year,0,1+7*((null===h||void 0===h?void 0:h.week)-1)),t=e.getDay(),n=e;return t<=4?n.setDate(e.getDate()-e.getDay()+1):n.setDate(e.getDate()+8-e.getDay()),n}var H=function(e){var t=e.data.lineParent,n=[{priority:0,quantity:0,name:""}];h.line.map((function(a){a.name===t&&a.product.map((function(t){t.days.map((function(a,i){if(e.column.caption.toLowerCase().includes(a.day)&&t.days[i].quantity>0&&null!==t.days[i].priority){var r={priority:t.days[i].priority,quantity:t.days[i].quantity,name:t.id};n.push(r)}}))}))})),n.shift();var i=n.sort((function(e,t){return e.priority-t.priority}));return Object(a.jsx)(a.Fragment,{children:i.map((function(e){return Object(a.jsx)("div",{children:Object(a.jsx)("li",{children:"".concat(e.priority,". ").concat(e.name,": ").concat(e.quantity)})})}))})};return Object(a.jsxs)(g.a,{children:[Object(a.jsxs)(f.a,{gutter:24,children:[Boolean(h.name)&&Object(a.jsx)(y.a,{span:6,children:Object(a.jsx)(O.a.Item,Object(u.a)(Object(u.a)({},g.b),{},{label:Object(o.c)("entities.planning.fields.name"),children:h.name}))}),Boolean(h.year)&&Object(a.jsx)(y.a,{span:6,children:Object(a.jsx)(O.a.Item,Object(u.a)(Object(u.a)({},g.b),{},{label:Object(o.c)("entities.planning.fields.year"),children:h.year}))}),Boolean(h.week)&&Object(a.jsx)(y.a,{span:6,children:Object(a.jsx)(O.a.Item,Object(u.a)(Object(u.a)({},g.b),{},{label:Object(o.c)("entities.planning.fields.week"),children:h.week}))}),Boolean(h.status)&&Object(a.jsx)(y.a,{span:6,children:Object(a.jsx)(O.a.Item,Object(u.a)(Object(u.a)({},g.b),{},{label:Object(o.c)("entities.planning.fields.status"),children:Object(o.c)("entities.planning.enumerators.status.".concat(h.status))}))})]}),Object(a.jsxs)(x.DataGrid,{dataSource:N,allowColumnReordering:!0,columnWidth:"auto",showBorders:!0,width:"100%",columnResizingMode:"widget",showRowLines:!0,onCellClick:function(e){var t;"data"===(t=e).rowType&&"Line"!==t.column.caption&&(I(t.column.caption),B(t.data),D(!0))},onRowPrepared:function(e){0===e.groupIndex?e.rowElement.style.background="#0aa3a3":1===e.groupIndex&&(e.rowElement.style.background="#00383B")},children:[Object(a.jsx)(x.ColumnChooser,{enabled:!0,mode:"select"}),Object(a.jsx)(x.Selection,{mode:"single"}),Object(a.jsx)(x.GroupPanel,{visible:!1}),Object(a.jsx)(x.Grouping,{autoExpandAll:!0,expandMode:"rowClick"}),Object(a.jsx)(x.Column,{caption:"Zap",dataField:"zapParent",allowEditing:!1,groupIndex:0}),Object(a.jsx)(x.Column,{caption:"Family",dataField:"familyParent",allowEditing:!1,groupIndex:1}),Object(a.jsx)(x.Column,{caption:"Line",dataField:"lineParent",allowEditing:!1}),Object(a.jsx)(x.Column,{caption:"Monday: ".concat(w()(Z()).format("DD/MM/YYYY")),allowEditing:!1,cellRender:function(e){return H(e)}}),Object(a.jsx)(x.Column,{caption:"Tuesday: ".concat(w()(Z()).add(1,"days").format("DD/MM/YYYY")),allowEditing:!1,cellRender:function(e){return H(e)}}),Object(a.jsx)(x.Column,{caption:"Wednesday: ".concat(w()(Z()).add(2,"days").format("DD/MM/YYYY")),allowEditing:!1,cellRender:function(e){return H(e)}}),Object(a.jsx)(x.Column,{caption:"Thursday: ".concat(w()(Z()).add(3,"days").format("DD/MM/YYYY")),allowEditing:!1,cellRender:function(e){return H(e)}}),Object(a.jsx)(x.Column,{caption:"Friday: ".concat(w()(Z()).add(4,"days").format("DD/MM/YYYY")),allowEditing:!1,cellRender:function(e){return H(e)}}),Object(a.jsx)(x.Column,{caption:"Saturday: ".concat(w()(Z()).add(5,"days").format("DD/MM/YYYY")),allowEditing:!1,cellRender:function(e){return H(e)}}),Object(a.jsx)(x.Column,{caption:"Sunday: ".concat(w()(Z()).add(6,"days").format("DD/MM/YYYY")),allowEditing:!1,cellRender:function(e){return H(e)}}),Object(a.jsx)(x.Scrolling,{}),Object(a.jsx)(x.Paging,{defaultPageSize:100}),Object(a.jsx)(x.Pager,{visible:!0,allowedPageSizes:!0,displayMode:"full",showPageSizeSelector:!0,showInfo:!0,showNavigationButtons:!0}),Object(a.jsx)(x.Summary,{children:Object(a.jsx)(x.GroupItem,{column:"id",summaryType:"count"})})]}),Object(a.jsx)(P.a,{width:"1200px",title:q,visible:Y,onOk:A,onCancel:function(){D(!1)},children:Object(a.jsx)(C,{data:z,header:q,onSubmit:function(e){localStorage.setItem("newRecord",JSON.stringify(e))}})})]})},S=n(663),Y=n(665),D=n(664);t.default=function(e){var t=Object(r.d)(),n=Object(c.h)(),u=Object(r.e)(d.a.selectLoading),s=Object(r.e)(d.a.selectRecord);return Object(i.useEffect)((function(){t(l.a.doFind(n.params.id))}),[]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Y.a,{items:[[Object(o.c)("dashboard.menu"),"/"],[Object(o.c)("entities.planning.menu"),"/planning"],[Object(o.c)("entities.planning.daily")]]}),Object(a.jsxs)(S.a,{children:[Object(a.jsxs)(f.a,{children:[Object(a.jsx)(y.a,{span:16,children:Object(a.jsx)(D.a,{children:Object(o.c)("entities.planning.daily")})}),Object(a.jsx)(y.a,{span:8,style:{textAlign:"end"}})]}),Object(a.jsx)(E,{loading:u,record:s})]})]})}},663:function(e,t,n){"use strict";var a=n(194);function i(){var e=Object(a.a)(["\n  margin: 0px;\n  margin-top: 16px;\n  padding: 24px;\n  border-radius: 5px;\n  background: #fff;\n  border: 1px solid #e9e9e9;\n  overflow-y: hidden;\n"]);return i=function(){return e},e}var r=n(195).a.div(i());t.a=r},664:function(e,t,n){"use strict";var a=n(194);function i(){var e=Object(a.a)(["\n  margin-bottom: 36px;\n"]);return i=function(){return e},e}var r=n(195).a.h1(i());t.a=r},665:function(e,t,n){"use strict";var a=n(11),i=n(735),r=(n(2),n(103));t.a=function(e){var t=function(e){return e.length>1};return Object(a.jsx)(i.a,{children:e.items.map((function(e){return Object(a.jsx)(i.a.Item,{children:t(e)?Object(a.jsx)(r.a,{to:e[1],children:e[0]}):e[0]},e[0])}))})}},699:function(e,t,n){"use strict";var a=n(11),i=n(701);n(2);t.a=function(e){return Object(a.jsx)("div",{style:{width:"100%",marginTop:"24px",marginBottom:"24px",display:"flex",justifyContent:"center",alignContent:"center",alignItems:"center"},children:Object(a.jsx)(i.a,{})})}},823:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var a=n(194);function i(){var e=Object(a.a)(["\n  padding: 24px;\n  padding-top: 0;\n  padding-bottom: 0;\n\n  .ant-form-item-label {\n    white-space: normal;\n  }\n\n  .ant-row {\n    margin-bottom: 8px;\n  }\n"]);return i=function(){return e},e}var r=n(195).a.div(i()),c={labelCol:{md:{span:6},lg:{span:4}},wrapperCol:{md:{span:18},lg:{span:12}}};t.a=r}}]);